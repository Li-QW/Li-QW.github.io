---
layout: wiki
title: 嵌入式 C 语言开发中的 tips
description: 学习过程中积累整理的知识点
keywords: C语言
---
```
学习过程中积累的知识点整理。不断更新中。
```
**目录**

* TOC
{:toc}

# Volatile 的秘密  

与 `const` 类似，`volatile` 也是一个类型修饰符，表示「**在编译器认识的范围外，这个数据可以改变**」。

由于访问寄存器的速度要快过直接访问内存的速度，所以编译器一般都会作出优化以减少对于内存的访问。编译器若发现在对某变量赋值之后没有再次改变该变量的值，则把变量值备份在一个寄存器中，在之后的操作中若再次使用该变量值的时候就直接操作这个寄存器，而不去读取其内存地址。

这在『外部环境』正在改变数据（可能通过多任务、多线程或者中断处理）的情况下可能会造成意想不到的结果，所以，`volatile` 告诉编译器不要擅自做出有关该数据的任何假定，优化期间尤其如此。

简单说来就是 **每次用到这个变量时必须每次都重新从内存中直接读取这个变量的值，而不是使用保存在寄存器里的备份。**

在实际使用中 `volatile` 的使用的场合大致有以下几点：

- **中断服务程序中修改的**供其它程序检测的变量；
- 多任务环境下各任务间共享的标志；
- 存储器映射的硬件寄存器。因为每次对它的读写都可能有不同意义。

参考链接：  
https://blog.csdn.net/bigloomy/article/details/6645810  
https://blog.csdn.net/bigloomy/article/details/6645810

